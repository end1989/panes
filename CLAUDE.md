# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Project Overview

Panes is a zero-dependency, single-file multi-stream viewer. Vanilla HTML/CSS/JavaScript, no frameworks, no build system. The entire application is `index.html`.

## Running

No build step. Open `index.html` in a browser, or use the Windows batch launchers:

- `launch.bat` — Interactive launcher (F11 fullscreen, Chrome App Mode, Kiosk Mode)
- `quick_launch.bat` — Direct Chrome App Mode at 1920x1080

No tests, linter, or formatter configured.

## Architecture

**Single-file monolith:** `index.html` contains all HTML, CSS, and JavaScript inline.

**Dynamic grid:** CSS Grid with `repeat(cols, 1fr)` / `repeat(rows, 1fr)`. Grid cells, iframes, and URL fields are all generated by `buildGrid()` from the current `cols` and `rows` values (1-6 each). No hardcoded cell count.

**Control panel:** A single unified panel (bottom-right, toggled by gear icon) contains a grid size picker (cols x rows with +/- buttons), dynamically generated URL fields, a zoom slider, and a fullscreen button. The URL list scrolls when there are many cells.

**URL conversion:** `toEmbedUrl()` transforms regular video URLs into embeddable format for YouTube (watch, shorts, live, youtu.be), Twitch (channels, VODs), Vimeo, Dailymotion, and Kick. Other URLs pass through as-is.

**Persistence:** `localStorage` key `borderlessGrid` stores `{ cols, rows, urls, zoom }` as JSON. Saved on every video load and grid resize. Restored on page load.

**Key functions:**
- `buildGrid()` — Rebuilds grid cells, iframes, and URL rows from current cols/rows
- `changeDim(dim, delta)` — Adjusts cols or rows, then rebuilds
- `togglePanel(forceOpen?)` — Show/hide control panel
- `enterFullscreen()` — Fullscreen API with vendor prefixes
- `loadVideo(index)` — Sets iframe src via toEmbedUrl, applies zoom, saves state
- `setZoom(value)` — Applies scale to all iframes
- `toEmbedUrl(raw)` — Converts platform URLs to embed format

**Keyboard shortcuts** (ignored when an INPUT is focused):
- `1`-`9`: Open panel and focus that URL field
- `F`: Toggle fullscreen
- `M`: Toggle control panel
- `Escape`: Close panel / blur input

**UI pattern:** Gear icon nearly invisible (opacity 0.3, 0.7 on hover). Panel slides up with fade+transform. Gear and cursor auto-hide after 3 seconds unless panel is open. All iframes have `allow="autoplay; fullscreen; encrypted-media; picture-in-picture"`.

## Conventions

- DOM elements use index-based IDs: `frame-0`..`frame-N`, `url-0`..`url-N` (generated dynamically)
- Inline `onclick` handlers call global functions with cell index
- CSS vendor prefixes for fullscreen and scrollbar hiding
- Iframes default to 200% scale with `transform: translate(-50%, -50%)` centering; zoom range 100%-300%
